<ng-container>
  <h1 bitTypography="h1">{{ "riskInsights" | i18n }}</h1>
  <div class="tw-text-main tw-max-w-4xl tw-mb-2">
    {{ "reviewAtRiskPasswords" | i18n }}
  </div>
  <div
    class="tw-bg-primary-100 tw-rounded-lg tw-w-full tw-px-8 tw-py-4 tw-my-4 tw-flex tw-items-center"
  >
    <i
      class="bwi bwi-exclamation-triangle bwi-lg tw-text-[1.2rem] tw-text-muted"
      aria-hidden="true"
    ></i>
    @if (dataLastUpdated) {
      <span class="tw-mx-4">{{
        "dataLastUpdated" | i18n: (dataLastUpdated | date: "MMMM d, y 'at' h:mm a")
      }}</span>
    } @else {
      <span class="tw-mx-4">{{ "noReportRan" | i18n }}</span>
    }
    @let isRunningReport = dataService.isGeneratingReport$ | async;
    <span class="tw-flex tw-justify-center">
      <button
        *ngIf="!isRunningReport"
        type="button"
        bitButton
        buttonType="secondary"
        class="tw-border-none !tw-font-normal tw-cursor-pointer !tw-py-0"
        tabindex="0"
        [bitAction]="generateReport.bind(this)"
      >
        {{ "riskInsightsRunReport" | i18n }}
      </button>
      <span>
        <i
          *ngIf="isRunningReport"
          class="bwi bwi-spinner bwi-spin tw-text-muted tw-text-[1.2rem]"
          aria-hidden="true"
        ></i>
      </span>
    </span>
  </div>
  <bit-tab-group [(selectedIndex)]="tabIndex" (selectedIndexChange)="onTabChange($event)">
    @if (isRiskInsightsActivityTabFeatureEnabled) {
      <bit-tab label="{{ 'activity' | i18n }}">
        <dirt-all-activity></dirt-all-activity>
      </bit-tab>
    }
    <bit-tab label="{{ 'allApplicationsWithCount' | i18n: appsCount }}">
      <dirt-all-applications></dirt-all-applications>
    </bit-tab>
    <bit-tab>
      <ng-template bitTabLabel>
        <i class="bwi bwi-star"></i>
        {{
          "criticalApplicationsWithCount"
            | i18n: (dataService.criticalReportResults$ | async)?.reportData?.length ?? 0
        }}
      </ng-template>
      <dirt-critical-applications></dirt-critical-applications>
    </bit-tab>
  </bit-tab-group>
</ng-container>
